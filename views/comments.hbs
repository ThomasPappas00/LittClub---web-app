<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/styles.css">
    <script src = "https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>   
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>LittClub · Topic</title>
    <style>
    .unchecked {
      
      color: rgb(172, 172, 172);
    }
    .checkednf{
      color:black;
    }
    .checkedf{
      color:rgb(241, 137, 0);
    }
</style>
  </head>
  <body>
  
<header class="p-3 bg-dark text-white">
        <div class="container">
          <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
            <div class="col-md-7">
              <button onclick="window.location.href='/home'" type="button" class="col-md-3 btn btn-default btn-lg"> 
                  <span class="glyphicon glyphicon-book"></span> LittClub </button>
      
              <ul class="nav col-md-6 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
              <li><a href="/profile" class="nav-link px-2 text-white">Profile</a></li>
              <li class="nav-item dropdown">
                <a class="nav-link px-2 text-white dropdown-toggle"  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Topics
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/topics">My Topics</a>
                  <a class="dropdown-item" href="/favorites">My Favorites</a>
                </div>
              </li>
              <li><a href="/faqlogged" class="nav-link px-2 text-white">FAQs</a></li>
              <li><a href="/aboutlogged" class="nav-link px-2 text-white">About</a></li>
              </ul>
            </div>
            <div class="col-md-5">
              <form class="col-sm-9" action="/search" method="post">
              <input type="search" class="form-control form-control-dark col-md-9" placeholder="Search..." aria-label="Search" name='search'>
              <button class="btn btn-outline-secondary col-md-3" type="submit">Search</button>
              </form>

      
              <div class="text-end col-md-3">
              <button onclick="window.location.href='/logout'" type="button" class="btn btn-warning">Log out</button>
                </div>
              </div> 
          </div>
      </div>
    </header>
  
      <hr>
  
      <div class="container marketing" style="min-height: 600px; ">
  
          <!-- START THE FEATURETTES -->       

          <div class="row rounded" style="background: #fdfcf9;">
                <div class="col-md-2">
                {{#if topic_photo_src}}
                <img class="featurette-image img-responsive center-block" data-src="holder.js/500x500/auto" alt="200x200" src=/{{{topic_photo_src}}} data-holder-rendered="true"  style="max-width: 200px; max-height:300px">
                
                {{else}}
                <img class="featurette-image img-responsive center-block" data-src="holder.js/500x500/auto" alt="200x200" src="/placeholders/image_placeholder.jpg" data-holder-rendered="true"  style="width: 200px; height:200px">
                <br><br>   <form action="/upload_topic_photo/{{topic_id}}" method="post" enctype="multipart/form-data">
               <label>
                      Add Picture <br>

                      <input type="file" id="file" name="file" accept="image/*">
                               <input type="submit" value="submit">
                  
                </label>
                </form>
                {{/if}}
                <p><h5> <b>Book title: <a href="/book/{{book_id}}">{{book_title}}</a> </b></h5></p> 
                <p><small> by <a href="/author/{{author}}">  {{author}}</a> </small></p>
                </div> 
                <div class="col-md-1"> </div>
                <div class="col-md-9"> 
                <div class="row">
                  <div class="col-md-9">
                    <h3 class="text-left">{{topic_title}}</h3>
                    <h4 class="text-left">by <a href="/profile/{{username}}">{{firstname}} {{lastname}}</a></h4>
                  </div>
                  <div class="col-md-1"></div>
                    <div class="col-md-2">
                      <div class="text-center ">
                      {{#if belongs}}
                        <button onclick="window.location.href='/deletetopic/{{topic_id}}'" class="btn btn-dark"> Delete <br />Topic</button>
                
                
                      {{else}}
                        {{#if is_following}}
                        <input type="image" onclick="window.location.href='/unfollow_topic/{{topic_id}}'" src="/photo_fav.png" style="width: 40px; height: 40px;" />
                        {{else}}
                        <input type="image" onclick="window.location.href='/follow_topic/{{topic_id}}'" src="/photo_unfav.png" style="width: 40px; height: 40px;" />
                        {{/if}}
                      {{/if}}
                      </div>

                  </div>

                </div>
                <div class="row">
                  <div class="col-md-8"></div>
                  <div class="col-md-1"></div>
                    <div class="col-md-3 ">
                      {{#if belongs}}
                        <div id="stardiv" {{#if stars}}avrating={{stars}} {{else}} avrating=0 {{/if}} haverated={{has_rated}} class="text-right">
                        <span id=1  class = "fa fa-star havetobepaint"></span>  
                        <span id=2 class = "fa fa-star havetobepaint"></span>  
                        <span id=3 class = "fa fa-star havetobepaint"></span>  
                        <span id=4 class = "fa fa-star havetobepaint"></span>  
                        <span id=5 class = "fa fa-star havetobepaint"></span> 
                        {{stars}}/5 </div>
                
                
                      {{else}}
                        <div id="stardiv" {{#if stars}}avrating={{stars}} {{else}} avrating=0 {{/if}} haverated={{has_rated}} class="text-right">
                        <a href="/rate_topic/{{topic_id}}/1" id=1  class = "fa fa-star havetobepaint"></a>  
                        <a href="/rate_topic/{{topic_id}}/2" id=2 class = "fa fa-star havetobepaint"></a>  
                        <a href="/rate_topic/{{topic_id}}/3" id=3 class = "fa fa-star havetobepaint"></a>  
                        <a href="/rate_topic/{{topic_id}}/4" id=4 class = "fa fa-star havetobepaint"></a>  
                        <a href="/rate_topic/{{topic_id}}/5" id=5 class = "fa fa-star havetobepaint"></a> 
                        {{stars}}/5 </div>
                
                      {{/if}}
                      
                  </div>

                </div>
                
                <div class="row">
                  <div class="col-md-8"></div>
                  <div class="col-md-1"></div>
                    <div class="col-md-3 ">
                      <div  class="text-right">
                          <p>Followed by {{followers}} people</p>
                  </div>

                </div>
                </div>
                <div class="row">
                  <div class="col-md-8"></div>
                  <div class="col-md-1"></div>
                    <div class="col-md-3 ">
                      <div  class="text-right">
                          <p>{{topic_created_on}}</p>
                  </div>

                </div>
                </div>
                
                <hr>
                <div class="row">
                <p>{{description}}</p>
                </div>

                
            </div> 
          </div>
          <hr class="featurette-divider">
          
            {{#if comments}}
                {{#each comments}}
                <div class="row text-center rounded" style="background: #fdfcf9; max-width: 80%; margin: auto; min-height: 60px;">
                    <div class="col-md-2">
                    {{#if user_photo_src}}
                    <img class="featurette-image img-responsive center-block" data-src="holder.js/500x500/auto" alt="200x200" src=/{{{user_photo_src}}} data-holder-rendered="true"  style="width: 50px; height:50px">
                    {{else}}
                    <img class="featurette-image img-responsive center-block" data-src="holder.js/500x500/auto" alt="200x200" src="/placeholders/person_placeholder.jpg" data-holder-rendered="true"  style="width:50px; height:50px">
                    {{/if}}
                    </div> 
                    <div class="col-md-1"> </div>
                    <div class="col-md-9"> 
                
                    <div class="row">
                      <div class="col-md-8">
                        <h5 class="text-left"><a href="/profile/{{username}}">{{username}}</a> commented </h5>
                      </div>
                      <div class="col-md-1"></div>
                        <div class="col-md-3"><h6 class="text-right" > on {{comment_created_on}}</h6>
                      </div>
                    </div>
                    <h4><div class="row text-justify"> {{comment}}</div></h4>
                    </div> 

                </div>
                <hr class="featurette-divider">
                {{/each}}
            {{else}}
            <h6>No comments yet</h6>
            {{/if}}
            <div class="row text-center rounded" style="background: #fdfcf9; max-width: 80%; margin: auto; min-height: 60px;">
              <form style="width: 100%;" action="/createcomment/{{topic_id}}" method="post">
                <div class="form-group" style="width: 100%;">
                  <textarea  type="text" name="comment" class="form-control" id="comment" placeholder="Write a comment"></textarea>
                
                </div>          
                <div class="form-group">
                <input type="submit" value="Comment">
                </div>
              </form>
            </div>

          
            
            

            <hr class="featurette-divider">
            

          <hr class="featurette-divider">
        

    
          <!-- /END THE FEATURETTES -->
    </div>
    
          <!-- FOOTER -->
          <footer>
            <p class="pull-right"><a href="#">Back to top</a></p>
            <p>© 2021 LittClub, Inc. · <a href="/termslogged">Terms</a></p>
          </footer>
      
      <script>
        window.addEventListener('DOMContentLoaded', (event) => {
        let lis = document.querySelectorAll(".havetobepaint");
        let div1 = document.getElementById('stardiv');
    
        let num_stars = div1.getAttribute('avrating');
        let haveRate= div1.getAttribute('haverated');
        for(let j=0;j<5;j++){   
          
          console.log('lis = '+lis[j].id)      
          if (lis[j].id<=num_stars){
            if (haveRate){
            lis[j].classList.add("checkedf");
              }
            else{
            lis[j].classList.add("checkednf");
            console.log(haveRate)
              }
            }
          else{lis[j].classList.add("unchecked");
          }
        }
        });

        
      </script>
    
      
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  </body>
</html>